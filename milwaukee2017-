/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var grass = /* color: #dee61c */ee.Feature(
        ee.Geometry.MultiPoint(
            [[-88.03227108012658, 43.06843708712473],
             [-88.03229522000771, 43.06843610739615],
             [-88.03229522000771, 43.068423370923306],
             [-88.03226705681305, 43.06840769526078],
             [-88.03229790221673, 43.06841063444783],
             [-88.02959328772708, 43.06759845118633],
             [-88.02955439569637, 43.06759845118633],
             [-88.02955305459186, 43.06758277531285],
             [-88.02958792330905, 43.06758865376586],
             [-88.02957317115947, 43.067560241237686],
             [-88.02953696133777, 43.067555342524585],
             [-88.01899104082011, 43.090780687561825],
             [-88.01898902916335, 43.090761100131616],
             [-88.01901920401477, 43.09076354856073],
             [-88.01901987456702, 43.090785094732766],
             [-88.01900780462645, 43.09077530101915],
             [-88.01501330445537, 43.08709981762763],
             [-88.01501062224635, 43.08705966097584],
             [-88.01501330445537, 43.08709002332475],
             [-88.01499587009677, 43.08709687933695],
             [-88.01498916457423, 43.087067496422165],
             [-88.01498916457423, 43.08708316731179],
             [-87.97237767230784, 43.094397026383106],
             [-87.97239108335292, 43.09439849535338],
             [-87.97239108335292, 43.09438429530595],
             [-87.97237364899432, 43.09437744010948],
             [-87.9724186943474, 43.0943985043559],
             [-87.97240930661584, 43.09437108357172],
             [-87.94598749232306, 43.08547147997293],
             [-87.94597743403925, 43.08542666983326],
             [-87.94597475183024, 43.085411977977074],
             [-87.8908746795233, 43.07954840061169],
             [-87.89082908197004, 43.07954840061169],
             [-87.89090686603147, 43.079564073424756],
             [-87.8908746795233, 43.079515095870526],
             [-87.87946025936579, 43.06926533205114],
             [-87.879497810292, 43.06929864236313],
             [-87.8795165857551, 43.06934370922699],
             [-87.88029979078745, 43.06933979037056],
             [-87.88028101532434, 43.0693143177978],
             [-87.88029710857843, 43.06925553489711],
             [-87.88035611717676, 43.069277088633896],
             [-87.87946025936579, 43.069329993228436],
             [-87.87891308872675, 43.06933391208548],
             [-87.8789050420997, 43.06930060179267],
             [-87.87897477953409, 43.06927316977324],
             [-87.87899623720621, 43.06924769717277],
             [-87.87903915255045, 43.06925357546612],
             [-87.87907670347666, 43.06933391208548],
             [-87.87891845314478, 43.069281007494325],
             [-87.87885408012842, 43.06925161603506],
             [-87.96759059901227, 43.06135144834276],
             [-87.96755573029508, 43.06141219850493],
             [-87.96753427262296, 43.06127306094779],
             [-87.96759059901227, 43.061280899691795],
             [-87.96901485199918, 43.06120839127149],
             [-87.9695767747878, 43.06111824554832],
             [-87.96939974899281, 43.06096636930188],
             [-87.96846634025563, 43.0612534640834],
             [-87.96846499915112, 43.06130343607525],
             [-87.89887870795498, 43.0574094674917],
             [-87.89879824168453, 43.05743690482018],
             [-87.90028113086859, 43.0407287952463],
             [-87.9001577492539, 43.04077584345214],
             [-87.90000218113104, 43.04078368481628],
             [-87.89991635044257, 43.040740557301135],
             [-87.87997857194321, 42.98195724391378],
             [-87.87991688113587, 42.98201611046876],
             [-87.88000807624238, 42.982141692264385],
             [-87.88004026275055, 42.98210048576597],
             [-87.87997052531617, 42.982069090320074],
             [-87.87984714370148, 42.98172962603753],
             [-87.87980691056626, 42.98178849281043],
             [-87.87989810567277, 42.98184539730401],
             [-88.07170255369336, 43.03137524319718],
             [-88.07179106659085, 43.03136151870522],
             [-88.0718366641441, 43.03130662070664],
             [-88.071817888681, 43.03126544717549],
             [-88.07167841381222, 43.031318384567626],
             [-88.07174010461956, 43.03132818778336],
             [-88.07179374879986, 43.03130662070664],
             [-88.07178033775479, 43.03134779421018],
             [-88.07108832782895, 43.03128701426667],
             [-88.0711875695625, 43.03116741484725],
             [-88.07113928980023, 43.03123603749344],
             [-88.07074500507504, 43.03133014842632],
             [-88.07083351797253, 43.031285053622334],
             [-88.07079060262829, 43.03127525039967],
             [-88.07051969951779, 43.031298778131394],
             [-88.07059748357922, 43.03126348653045],
             [-88.07024611419827, 43.031300738775315],
             [-88.07006640619427, 43.03126544717549],
             [-88.0699081558624, 43.03139681024981],
             [-88.0699457067886, 43.031355636779146],
             [-88.06980354971081, 43.03134779421018],
             [-88.06964798158795, 43.031394849608965],
             [-88.06960506624371, 43.0314517081677],
             [-88.06952728218228, 43.03146347200088],
             [-88.06959433740765, 43.031394849608965],
             [-88.07176156229168, 43.03096938906663],
             [-88.07170255369336, 43.03099487756927],
             [-88.07158185428769, 43.03101448410254],
             [-88.07190103716046, 43.03098899560805],
             [-88.07195736354977, 43.031002720183345],
             [-88.07137532419354, 43.030979192338116],
             [-88.07143165058285, 43.0309615464483],
             [-87.99427224924654, 42.99313107119884],
             [-87.99428029587358, 42.99310164325013],
             [-87.99428566029161, 42.993057501300605],
             [-87.99428163697809, 42.9930398445119],
             [-87.99429236581415, 42.992997664385065],
             [-87.99428163697809, 42.99296333170232],
             [-87.99431114127725, 42.99295842703177],
             [-87.99433930447191, 42.99300060718554],
             [-87.99442647626489, 42.99300158811902],
             [-87.99448816707223, 42.99300158811902],
             [-87.99454583456605, 42.992996683451544],
             [-87.99454851677507, 42.9929397892802],
             [-87.9936526589641, 42.992936846476795],
             [-87.99362181356042, 42.99294567488657],
             [-87.99357956876844, 42.99291183264222],
             [-87.99354470005125, 42.99291183264222]]),
        {
          "class_2017": 0,
          "system:index": "0"
        }),
    impervious = /* color: #ff2919 */ee.Feature(
        ee.Geometry.MultiPoint(
            [[-88.01502537439593, 43.08708708503358],
             [-88.01502537439593, 43.08706945528358],
             [-88.01502470384368, 43.087110591359],
             [-88.01500391672381, 43.08712136508847],
             [-88.01504012654551, 43.08709296161579],
             [-87.97236560236728, 43.09439017118807],
             [-87.97236426126277, 43.094414654024014],
             [-87.97236359071051, 43.0943681366273],
             [-87.96800634140958, 43.06155133574629],
             [-87.96804389233579, 43.06132597245038],
             [-87.9081205795741, 43.04049518939259],
             [-87.90784162983655, 43.03905235473529],
             [-87.90771288380384, 43.0384563913886],
             [-87.90644688114881, 43.03798588992084],
             [-87.9041938255763, 43.04047950658958],
             [-87.92028707966566, 43.043788489213895],
             [-87.90001827438513, 43.03757648326938],
             [-87.90277022083441, 43.03867824255682],
             [-87.90495890339056, 43.039713329344075],
             [-87.90544170101325, 43.03956434065507],
             [-87.90282386501471, 43.040536681364635],
             [-87.89951938350836, 43.0398701591522],
             [-87.90361779888312, 43.03921147126427],
             [-87.90481406410376, 43.03962707277874],
             [-87.90851551254431, 43.040383773967655],
             [-87.90697592456976, 43.03940751006524],
             [-87.89998608787695, 43.03771763503029],
             [-87.9004098769013, 43.03842730979692],
             [-87.9002462621514, 43.038493963911364],
             [-87.90036427934805, 43.03848416184024],
             [-87.90000218113104, 43.03850768680829],
             [-87.99411319284548, 42.9536735485342],
             [-87.9941185572635, 42.953651954189546],
             [-87.9941346505176, 42.95359404204595],
             [-87.99389861612428, 42.953489014799096],
             [-87.99387447624315, 42.953469383518105],
             [-87.99396030693163, 42.95350962763738]]),
        {
          "class_2017": 1,
          "system:index": "0"
        }),
    soil = /* color: #a78839 */ee.Feature(
        ee.Geometry.MultiPoint(
            [[-87.9112867676882, 43.13229851627674],
             [-87.91199487086813, 43.1321340932446],
             [-87.91108291980306, 43.13178958641059],
             [-87.90144842502157, 43.131225843769016],
             [-87.91145740749177, 43.132348822299065],
             [-87.911859738844, 43.13228422764231],
             [-87.89644861901098, 43.07326132860991],
             [-87.89626622879797, 43.07304188629223],
             [-87.92110309807167, 43.05792183463784],
             [-87.92062030044899, 43.05733389384729],
             [-87.92060957161293, 43.05727117983023],
             [-87.9207490464817, 43.05731821534904],
             [-88.05233839650376, 42.84752325008369],
             [-88.04946306843979, 42.84742885779024],
             [-88.05259588856919, 42.84934813940562],
             [-88.06517882531729, 42.84713953935863],
             [-88.06605858987417, 42.84812672291728],
             [-88.0667666930541, 42.847410918084584],
             [-87.84567797056879, 42.89101267151991],
             [-87.84655773512567, 42.89245112224917],
             [-87.84601056448663, 42.89185373694855],
             [-87.88620078436578, 42.88427587385693],
             [-87.88698398939813, 42.88510130868659],
             [-87.88704836241449, 42.88411078556565],
             [-87.88929068915094, 42.882554217100115],
             [-87.88668358198846, 42.88589528795847],
             [-88.07141287511975, 43.03172031512956],
             [-88.07116611189038, 43.03190069286753],
             [-88.07058112557509, 43.031461544090945],
             [-88.07046310837843, 43.031590946110995],
             [-88.07051407034972, 43.03153800895397],
             [-88.07040946419814, 43.031708584074295],
             [-87.9931082850129, 42.992298857911955]]),
        {
          "class_2017": 2,
          "system:index": "0"
        }),
    tree = /* color: #23c049 */ee.Feature(
        ee.Geometry.MultiPoint(
            [[-87.89793756998664, 43.032077221511194],
             [-87.89763716257697, 43.03341042799523],
             [-87.90634897745734, 43.03114395974015],
             [-87.90689614809638, 43.031136117144136],
             [-87.9043963292945, 43.03215564622374],
             [-87.90282455481177, 43.032304652901495],
             [-87.90260461367255, 43.032328180238565],
             [-87.89873686827308, 43.03283793699427],
             [-87.89854911364203, 43.032881070063944],
             [-87.89836672342902, 43.032826173424574],
             [-87.89762106932288, 43.03308497143738],
             [-87.89247729940969, 43.0795092185614],
             [-87.89244108958799, 43.07965223292376],
             [-87.89253764911253, 43.079287839506534],
             [-87.87949512808298, 43.06925749432805],
             [-87.87953804342722, 43.0692868857845],
             [-87.87949244587396, 43.069230062289314],
             [-87.87926177589868, 43.069602353196196],
             [-87.87931273786997, 43.06957100247017],
             [-87.87936906425928, 43.06960627203581],
             [-87.87932346670603, 43.06963566332501],
             [-87.88027028648828, 43.06925161603506],
             [-87.88024882881616, 43.06922026512965],
             [-87.88019250242685, 43.06922026512965],
             [-87.88015763370966, 43.06925749432805],
             [-87.88024882881616, 43.069308439510245],
             [-87.88027833311533, 43.069349587511105],
             [-87.88022200672602, 43.06937897892342],
             [-87.87895600407099, 43.06926533205114],
             [-87.87896405069803, 43.069249656603965],
             [-87.87889699547266, 43.06925749432805],
             [-87.87890772430872, 43.069232021721064],
             [-87.87891577093576, 43.06918695477509],
             [-87.87896941511606, 43.06921830569752],
             [-87.95716072635966, 43.062816196628695],
             [-87.9571862073453, 43.0628495104453],
             [-87.95713792758303, 43.06277602406107],
             [-87.95715536194163, 43.062604555488726],
             [-87.9571312220605, 43.062607494954],
             [-87.95716072635966, 43.062655506200294],
             [-87.95783798413592, 43.062475218876855],
             [-87.95781384425479, 43.062465420637565],
             [-87.95777227001506, 43.06247227940521],
             [-87.95833687501269, 43.062476198700686],
             [-87.95829932408648, 43.06248305746714],
             [-87.9142638588644, 43.06088607118676],
             [-87.91427190549145, 43.06077044886645],
             [-87.91425313002834, 43.061021290233896],
             [-87.91427995211849, 43.06115846867261],
             [-87.91396881587276, 43.06127800963324],
             [-87.91403587109814, 43.06116238805208],
             [-87.91295762307415, 43.06048629139016],
             [-87.91308100468883, 43.0604882511014],
             [-87.91313196666012, 43.06057643804252],
             [-87.91294152982006, 43.06057055891705],
             [-87.91320438630352, 43.06060779336879],
             [-87.91261161811123, 43.0608155220003],
             [-87.91259016043911, 43.06076456975962],
             [-87.91261966473827, 43.06101737084541],
             [-87.91259016043911, 43.06109771825905],
             [-87.91256602055797, 43.06105656471888],
             [-87.91258479602108, 43.060913506959565],
             [-87.91254724509487, 43.06092918453853],
             [-87.91138584859142, 43.06068226220441],
             [-87.91132415778408, 43.0606763830891],
             [-87.91133488662014, 43.060629350146286],
             [-87.91275913960705, 43.05938100426903],
             [-87.91280205495129, 43.05938492376211],
             [-87.9127859616972, 43.05949466946661],
             [-87.91271085984478, 43.059514266893146],
             [-87.91271890647182, 43.05961225393198],
             [-87.91278059727917, 43.059594616276556],
             [-87.91279669053326, 43.059714160286276],
             [-87.9136871839262, 43.05979058994081],
             [-87.91359867102871, 43.0597945094077],
             [-87.91398222691784, 43.0596632071303],
             [-87.91404391772518, 43.0596632071303],
             [-87.91587586648235, 43.059584817576905],
             [-87.9157954002119, 43.059631851320965],
             [-87.91581954009304, 43.05959657601631],
             [-87.89768780715237, 43.056819561959976],
             [-87.90253724105129, 43.05899885249076],
             [-87.90362890012035, 43.057873940611394],
             [-87.90361548907528, 43.05785826225123],
             [-87.90115053899059, 43.057413387110806],
             [-87.90108884818325, 43.05743102539368],
             [-87.96354633255716, 42.840397888492504],
             [-87.96341758652444, 42.840390021566265],
             [-87.96217304154153, 42.840382154639016],
             [-87.96123963280435, 42.84070469783455],
             [-87.9651020137858, 42.839571855768334],
             [-87.94555365381572, 42.97712036044788],
             [-87.94557779369686, 42.977100736706696],
             [-87.94558047590587, 42.976731809206846],
             [-87.94557511148784, 42.97669452385764],
             [-87.94556035933826, 42.976592479628444],
             [-87.94556572375629, 42.976549307018935],
             [-87.94562473235462, 42.97651888993497],
             [-87.94559254584644, 42.976482585653756],
             [-87.94564619002674, 42.97639427785322],
             [-87.94571458635662, 42.97644039416486],
             [-87.94364638225063, 42.9765340929837],
             [-87.94361419574246, 42.97649386392399],
             [-87.9435323883675, 42.97649876990829],
             [-87.94357798592075, 42.976576284408274],
             [-87.94352300063595, 42.97653998016096],
             [-87.9434774030827, 42.976653798810574],
             [-87.94343046442494, 42.97667440388841],
             [-87.9434237589024, 42.9766273065575],
             [-87.93750937782669, 42.978625619888874],
             [-87.93759789072418, 42.978596184995325],
             [-87.93765153490448, 42.978535352837305],
             [-87.93765153490448, 42.97846470896539],
             [-87.93758984409713, 42.97842742466696],
             [-87.93748792015457, 42.97844901031616],
             [-87.93742354713821, 42.97853731516594],
             [-87.93746378027343, 42.97878456807058],
             [-87.93753888212585, 42.97875120860973],
             [-87.93625946842575, 42.97886698548453],
             [-87.93620582424545, 42.97891211878344],
             [-87.93626483284378, 42.978541239822995],
             [-87.93632920586013, 42.9785098425596],
             [-87.93626215063476, 42.97819194436495],
             [-87.93633993469619, 42.978115413072636],
             [-87.93498810135269, 42.978529465851096],
             [-87.93508734308624, 42.97860599662806],
             [-87.93519463144683, 42.978507880230104],
             [-87.93522145353698, 42.97871588680791],
             [-87.93506588541412, 42.9779132915093],
             [-87.93638116509827, 42.9758199704622],
             [-87.93652868659409, 42.97589061737259],
             [-87.93543970973404, 42.975710075106974],
             [-87.93527877719315, 42.97571399994448],
             [-87.93728506953629, 42.975702225431235],
             [-87.93789393098267, 42.97572381203712],
             [-87.93781614692124, 42.975717924781726],
             [-87.93805754573258, 42.975729699291946],
             [-87.93799317271622, 42.97572184961872],
             [-87.9383686819783, 42.97569633817375],
             [-87.93830699117096, 42.97566886429814],
             [-87.93824530036362, 42.97573656775522],
             [-87.8992189760987, 43.0400465922072],
             [-87.89914923866431, 43.04010540311276],
             [-87.89905267913977, 43.04001130563679],
             [-87.89872544963995, 43.04023478690664],
             [-87.8990580435578, 43.04052491927069],
             [-87.89893466194312, 43.04052883996892],
             [-87.87980154614823, 42.98172962603753],
             [-87.8797425375499, 42.98165506137755],
             [-87.879941021017, 42.981925848394745],
             [-87.87989005904572, 42.98198471497979],
             [-87.87984446149247, 42.98188856619505],
             [-87.87989274125474, 42.98213580562342],
             [-87.87995979648011, 42.9821711254606],
             [-87.87999734740632, 42.982102447980814],
             [-87.88013682227509, 42.982257462754944],
             [-87.8800483093776, 42.982241765074086],
             [-87.88022265296357, 42.98243209918422],
             [-87.88016364436524, 42.98238108185168],
             [-88.07191165661568, 43.0309415788061],
             [-88.07194116091485, 43.03092785421713],
             [-88.07193981981034, 43.030896483716596],
             [-88.07188349342103, 43.03088864108896],
             [-88.07185935353989, 43.03091609028132],
             [-88.07176413511986, 43.03092197224951],
             [-88.07175474738831, 43.03089354273134],
             [-88.07172658419366, 43.030870995173096],
             [-88.07167025780434, 43.030911188640715],
             [-88.0717694995379, 43.03081413607638],
             [-88.07181509709115, 43.03078864749868],
             [-88.0717708406424, 43.03075727692696],
             [-88.07172390198464, 43.03077688353617],
             [-88.0717694995379, 43.03079649013909],
             [-88.071428858993, 43.030899424701715],
             [-88.07139935469384, 43.03086805418661],
             [-88.07134571051354, 43.03088275911757],
             [-88.0713564393496, 43.030923932905445],
             [-88.07153480624909, 43.03093177552858],
             [-88.07157772159333, 43.030956283719405],
             [-88.07152810072655, 43.03097981157341],
             [-88.07149725532288, 43.03096020502903],
             [-88.07189288115258, 43.03023181746745],
             [-88.07186605906243, 43.03023083712844],
             [-88.07180034494156, 43.030341615338244],
             [-88.07176145291085, 43.03033867432641],
             [-87.9942467682609, 42.99312714747318],
             [-87.99425883820146, 42.99309379579475],
             [-87.99425347378343, 42.993051615704935],
             [-87.99426956703752, 42.99300158811902],
             [-87.99427224924654, 42.99298000757919],
             [-87.99425213267892, 42.99294861768955],
             [-87.99422396948427, 42.99293782741128],
             [-87.99424542715639, 42.99298196944676],
             [-87.99420787623018, 42.99297804571155],
             [-87.9941582553634, 42.99299177878366],
             [-87.99404292037576, 42.993079081813214],
             [-87.99409522345155, 42.99307221528727],
             [-87.99413545658678, 42.99304769197418],
             [-87.9940134160766, 42.99309281486275],
             [-87.99395440747827, 42.99309085299872],
             [-87.9939235620746, 42.99308398647412],
             [-87.99387796452135, 42.993094776726714],
             [-87.99384175469964, 42.99306829155785],
             [-87.99412660389055, 42.95359993141898],
             [-87.99411319284548, 42.953573429235966],
             [-87.99411989836801, 42.95364213857582],
             [-87.99410112290491, 42.95365588043458],
             [-87.9940997818004, 42.95368630882524],
             [-87.99410514621843, 42.95372557124253],
             [-87.994117216159, 42.95348214385146],
             [-87.99410782842745, 42.95351944327225],
             [-87.99408637075533, 42.95346643882542],
             [-87.99404077320207, 42.953412452767864],
             [-87.99398444681276, 42.953381042676206],
             [-87.99389056949724, 42.95345171535989],
             [-87.99391605048288, 42.953485088543395]]),
        {
          "class_2017": 3,
          "system:index": "0"
        }),
    water = /* color: #2b54ff */ee.Feature(
        ee.Geometry.MultiPoint(
            [[-87.90089052554647, 43.134154116993656],
             [-87.90105145808737, 43.13240813138591],
             [-87.9013089501528, 43.131225843769016],
             [-87.89256313009817, 43.07929567594693],
             [-87.89251350923139, 43.079324083034884],
             [-87.89248936935026, 43.07950530035497],
             [-87.89245450063306, 43.07965027382515],
             [-87.89324069702917, 43.076905523649444],
             [-87.89318705284887, 43.076607726594574],
             [-87.89283300125891, 43.07538517615089],
             [-87.89400249986656, 43.06942406348454],
             [-88.06643608708603, 42.85737072010619],
             [-88.0667364944957, 42.857362855341336],
             [-88.06873184128519, 42.8474855820089],
             [-88.06868892594095, 42.84788871438452],
             [-88.06938630028482, 42.84824858155086],
             [-88.0685548154902, 42.848854254889424],
             [-88.06881767197366, 42.849349801385415],
             [-88.069059070785, 42.849172820950386],
             [-87.89496767481009, 43.03833124932817],
             [-87.89420592744986, 43.03470828757622],
             [-87.89391624887625, 43.040354368655315],
             [-87.84466516841347, 42.93725378278921],
             [-87.8438068615287, 42.93975148932287],
             [-87.84035217631752, 42.939154562383735],
             [-87.84399775510123, 42.90431454371686],
             [-87.84091857915213, 42.904534589239226],
             [-87.83911613469412, 42.90437741394625],
             [-87.83004756665193, 42.85060807047971],
             [-87.82807346081697, 42.85281040638351],
             [-87.83000465130769, 42.852889059784786],
             [-87.82650705075227, 42.854886822592334],
             [-87.83249374127351, 42.853707049219956],
             [-87.8682040564748, 42.98815517472169],
             [-87.870221077654, 42.988657450203036],
             [-87.86676639244281, 42.98693086104114]]),
        {
          "class_2017": 4,
          "system:index": "0"
        }),
    treeRemoved = ee.FeatureCollection("users/erkere/removed_trees"),
    imageVisParam = {"opacity":1,"bands":["b1"],"min":-43.57360369780443,"max":74.44605267739627,"gamma":1};
/***** End of imports. If edited, may not auto-convert in the playground. *****/
var milwaukeeExport = ee.Geometry.Polygon(
        [[[-88.35575750089527, 43.35209206347098],
          [-88.35575750089527, 42.80743795582355],
          [-87.76249578214527, 42.80743795582355],
          [-87.76249578214527, 43.35209206347098]]], null, false),
    wb = ee.Image("users/erker/milwaukee/milwaukee_water/mke_water_bodies_26916_input"),
    wl = ee.Image("users/erker/milwaukee/milwaukee_water/mke_water_lines_26916_input"),
    height = ee.Image("users/erker/milwaukee/milwaukee_height/mke_2015height");

var pts = ee.FeatureCollection('users/erker/milwaukee/milwaukee_shapefiles/milwaukee_accuracy_training');

var classProperty = 'class_2017';

var pts = pts.remap(['G','I','S','T','W'], [0,1,2,3,4], classProperty);


var testpts = ee.FeatureCollection('users/erker/milwaukee/milwaukee_shapefiles/milwaukee_accuracy_testing').filter(ee.Filter.neq(classProperty, '')).remap(['G','I','S','T','W'], [0,1,2,3,4], classProperty);



var buf3000 = function(feature) {return feature.buffer(3000)};
var urbanregion = testpts.map(buf3000);
var naip = ee.ImageCollection('USDA/NAIP/DOQQ').filterBounds(urbanregion); 
var naip17c = naip.filterDate('2017-01-01', '2017-12-31');
var naip18c = naip.filterDate('2018-01-01', '2018-12-31');



var naip17 = naip17c.median().byte();
var naip18 = naip18c.median().byte();


var gauss53 = ee.Kernel.gaussian({radius: 5, sigma: 3, units: 'pixels', normalize:true});
var naip17Gauss53 = naip17.convolve(gauss53);
var naip18Gauss53 = naip18.convolve(gauss53);
var heightGauss53 = height.convolve(gauss53);
var win10 = ee.Kernel.square({radius: 10});
var entro10 = naip17.select('N').entropy(win10);
var win5 = ee.Kernel.square({radius: 5});
var entro5 = naip17.select('N').entropy(win5);
var nir17glcm3 = naip17.select(['N']).glcmTexture({size: 3, average: false});
var contrast3 = nir17glcm3.select('N_contrast_-1_-1', 'N_contrast_0_-1', 'N_contrast_1_-1', 'N_contrast_-1_0');
var nir17glcm7 = naip17.select(['N']).glcmTexture({size: 7, average: false});
var contrast7 = nir17glcm7.select('N_contrast_-1_-1', 'N_contrast_0_-1', 'N_contrast_1_-1', 'N_contrast_-1_0');
var nir17glcm14 = naip17.select(['N']).glcmTexture({size: 14, average: false});
var contrast14 = nir17glcm14.select('N_contrast_-1_-1', 'N_contrast_0_-1', 'N_contrast_1_-1', 'N_contrast_-1_0');

// Create a list of weights for a 5x5 kernel.
var bottomList = [0, 0, 0, 0, 1];
var list =       [0, 0, 0, 0, 0];
var lists = [list, list, list, list, bottomList];
var shift1 = ee.Kernel.fixed(5, 5, lists, -3, -3, false);
var shift2 = shift1.rotate(1);
var shift3 = shift1.rotate(2);
var shift4 = shift1.rotate(3);
var heightshift1 = height.convolve(shift1);
var heightshift2 = height.convolve(shift2);
var heightshift3 = height.convolve(shift3);
var heightshift4 = height.convolve(shift4);



var image = ee.Image.cat([naip17, naip17Gauss53, naip18, naip18Gauss53, entro5, contrast3, contrast7, wl, wb, height, heightGauss53]);
var image = ee.Image.cat([naip17, naip17Gauss53, naip18Gauss53, entro5, contrast3, wl, wb, height, heightshift1, heightshift2, heightshift3, heightshift4]);

print(image);

// var training = image.sampleRegions({
//   collection: trainingData,
//   properties: [classProperty],
//   scale: 1
// });


var trainingGrass = image.sampleRegions({collection: grass, properties: [classProperty], scale: 1})
var trainingImpervious = image.sampleRegions({collection: impervious, properties: [classProperty], scale: 1})
var trainingSoil = image.sampleRegions({collection: soil, properties: [classProperty], scale: 1})
var trainingTree = image.sampleRegions({collection: tree, properties: [classProperty], scale: 1})
var trainingWater = image.sampleRegions({collection: water, properties: [classProperty], scale: 1})
var trainingPts = image.sampleRegions({collection: pts, properties: [classProperty], scale: 1});

var training = trainingPts.merge(trainingGrass).merge(trainingTree).merge(trainingSoil).merge(trainingImpervious).merge(trainingWater);
print(training.size());


var trainedClassifier = ee.Classifier.smileRandomForest(10).train({
  features: training,
  classProperty: classProperty,
  inputProperties: image.bandNames()
});

print(trainedClassifier);

var testing = image.sampleRegions({collection: testpts, properties: [classProperty], scale: 1});

var testClassified = testing.classify(trainedClassifier);
var testAccuracy = testClassified.errorMatrix(classProperty, 'classification');
print('testing error matrix: ', testAccuracy);
print('testing overall accuracy: ', testAccuracy.accuracy());


var classified = image.classify(trainedClassifier);

Map.addLayer(height);
Map.addLayer(naip18);
Map.addLayer(naip17);
Map.addLayer(classified, {min: 0, max: 4, palette: ['yellow', 'red', 'brown','green','blue']});
Map.addLayer(treeRemoved);



Export.image.toDrive({
  image: classified,
  description: 'milwaukee-2017-fullcounty',
  scale: 1,
        region: milwaukeeExport,
  maxPixels: 12000000000,
  crs: 'EPSG:3070'
});


Export.image.toAsset({
  image: classified,
  description: 'milwaukeeClassified2017',
  assetId: 'milwaukeeClassified2017',
  scale: 1,
  maxPixels: 12000000000,
  region: milwaukeeExport,
  pyramidingPolicy: {
    'classification': 'mode'
  }
});